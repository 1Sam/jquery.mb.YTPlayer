<!doctype html>

<!--
  ~ jquery.mb.components
  ~ Copyright (c) 2001-2010. Matteo Bicocchi (Pupunzi); Open lab srl, Firenze - Italy
  ~ email: mbicocchi@open-lab.com
  ~ site: http://pupunzi.com
  ~
  ~ Licences: MIT, GPL
  ~ http://www.opensource.org/licenses/mit-license.php
  ~ http://www.gnu.org/licenses/gpl.html
  -->

<html>
<head>
  <title>mb.YTPlayer - A youtube custom Player</title>
  <link href="../css/mb.YTVPlayer.css" media="all" rel="stylesheet" type="text/css">
  <style type="text/css">
    body{
      background: #333;
      margin:0;
    }
    #content{
      color:white;
      font:40px/40px Calibri;
      text-align:center;
      padding-top:120px;
      text-shadow:#666666 2px 2px 4px;
    }
    .movie{
      display:none;
    }
    .dida{
      position:fixed;
      bottom:0;
      font: 12px/14px Arial, sans-serif;
      color:white;
      padding:10px;
    }

    span.button:hover{
      color:yellow;
    }

  </style>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script type="text/javascript" src="swfobject.js"></script>
  <script type="text/javascript">
    /*
    http://pupunzi.com/test/video/Birds.mov
    http://dl.dropbox.com/u/1976976/video/Birds.mov
    http://pupunzi.com/test/video/distanza_in_stanza_3.flv
    */

    $(function(){

      document.mbCP= new Object();
      var flashVar={
        videoUrl:"http://dl.dropbox.com/u/1976976/video/Birds.mov",
        showFlashControls:false,
        ID:"mySwf",
        loop:false,
        autoplay:false,
        placeHolderUrl:"placeholder.png"
      };
      var params = { allowScriptAccess: "always", wmode:"transparent", allowFullScreen:"true" };
      //swfobject.embedSWF(swfUrl, id, width, height, version, expressInstallSwfurl, flashvars, params, attributes, callbackFn)
      swfobject.embedSWF("chromeless_player.swf","mySwf","500","390","9.0.0",null,flashVar,params);//http://pupunzi.com/test/a/chromeless_player.swf
      $("#state").hide();

    });

    function onMbPlayerReady(playerID){
      var player= $("#"+playerID);
      //player.css({position:"absolute", width:"100%", height:"100%", top:0,left:0});
      //$("body").css({position:"relative",zIndex:2});
      player.setTimeInfo("state");
    }

    function updateMovieState(ID, videoUrl, currentTime, duration, bytesLoaded, bytesTotal, volume, isPlaying,infocode){
      if (typeof document.mbCP[ID]!="object") document.mbCP[ID]=new Object();
      document.mbCP[ID].videoUrl = videoUrl;
      document.mbCP[ID].currentTime = currentTime;
      document.mbCP[ID].duration = duration;
      document.mbCP[ID].bytesLoaded = bytesLoaded;
      document.mbCP[ID].bytesTotal = bytesTotal;
      document.mbCP[ID].volume = volume;
      document.mbCP[ID].isPlaying = eval(isPlaying);
      document.mbCP[ID].infoCode= infocode;
    }

    function formatTime(s){
      var min= Math.floor(s/60);
      var sec= Math.floor(s-(60*min));
      return (min<=9?"0"+min:min)+":"+(sec<=9?"0"+sec:sec);
    }

    $.fn.getvideoUrl=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].videoUrl;
    };

    $.fn.getCurrentTime=function(format){
      var player= $(this).get(0);
      var time=document.mbCP[player.id].currentTime;
      if (format)
        time=formatTime(time);
      return time ;
    };

    $.fn.getDuration=function(format){
      var player= $(this).get(0);
      var duration=document.mbCP[player.id].duration;
      if (format)
        duration=formatTime(duration);
      return duration ;
    };

    $.fn.getbytesLoaded=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].bytesLoaded;
    };

    $.fn.getbytesTotal=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].bytesTotal;
    };

    $.fn.getPlayingState=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].isPlaying;
    };

    /*AUDIO*/
    $.fn.getVolume=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].volume;
    };

    $.fn.setVoume=function(val){
      var player= $(this).get(0);
      player.setVoume(val);
    };

    $.fn.getInfoCode=function(){
      var player= $(this).get(0);
      return document.mbCP[player.id].infoCode;
    };
    // video actions
    $.fn.stopVideo=function(){
      var player= $(this).get(0);
      player.stopVideo(true);
    };

    $.fn.playVideo=function(){
      var player= $(this).get(0);
      player.playVideo();
    };

    $.fn.pauseVideo=function(){
      var player= $(this).get(0);
      player.pauseVideo();
    };

    $.fn.seekTo=function(val){
      var player= $(this).get(0);
      player.seekTo(val);
    };

    // fullscreen needs a real click -- it doesn't work from a js call
    $.fn.fullScreenMovie=function(){
      var player= $(this).get(0);
      player.fullScreenMovie();
    };

    //load video
    $.fn.loadVideoByUrl=function(url,play){
      var player= $(this).get(0);
      player.loadVideoByUrl(url,play);
    };

    // Update time
    $.fn.setTimeInfo=function(where){
      var movie=$(this);
      setInterval(function(){
        var s=movie.getCurrentTime(true)+" of "+movie.getDuration(true);
        if(typeof movie.getDuration()=="number")
        $("#"+where).html(s);
        $("#"+where).slideDown("slow");
      },1000);

    };

    $.fn.traceState=function(){
      var player= $(this).get(0);
      console.debug(":::::::::::::::::::::::::::::::::::::::::::");
      console.debug("current URL:: ",$(this).getvideoUrl());
      console.debug("current time:: ",$(this).getCurrentTime(true));
      console.debug("duration:: ",$(this).getDuration(true));
      console.debug("bytes loaded:: ",$(this).getbytesLoaded());
      console.debug("total bytes:: ",$(this).getbytesTotal());
      console.debug("is playing:: ",$(this).getPlayingState());
      console.debug("volume:: ",$(this).getVolume());
      console.debug("code:: ",$(this).getInfoCode());
    };


  </script>

</head>
<body>
<div id="content">

  <img src="http://pupunzi.com/images/logo.png" alt="mb">
  <br><br>
  <div class="mbVideoControls" style="font-size:80%; cursor:pointer">
    <span  class="stop button" onclick="$('#mySwf').stopVideo()">stop</span> |
    <span class="play button" onclick="$('#mySwf').playVideo()">play</span> |
    <span class="pause button" onclick="$('#mySwf').pauseVideo()">pause</span> |
    <span class="seek button" onclick="$('#mySwf').seekTo($('#goto').val())">go to: </span><input id="goto" type="text" value="0" style="width:50px; font-size:60%"/> |
    <span class="volme button" onclick="$('#mySwf').setVoume($('#vol').val())">volume: </span><input id="vol" type="text" value="0" style="width:50px; font-size:60%"/> |
    <span class="button"  onclick="$('#mySwf').traceState()">console</span>
    <div id="state" style="font-size:70%"></div>
  </div>
  <div id="mySwf"></div>
  <br>
  <span  onclick="$('#mySwf').loadVideoByUrl('mat2 - Computer.m4v',false)" style="cursor:pointer">load 1</span> |
  <span onclick="$('#mySwf').loadVideoByUrl('Bill_Viola_-_the_Crossing.flv',false)" style="cursor:pointer">load 2</span>

  <br>
</div>

</body>

</html>